# Empire

- https://github.com/BC-SECURITY/Empire
- https://github.com/BC-SECURITY/Starkiller
- https://bc-security.gitbook.io/empire-wiki/

Both Empire and Starkiller(Client GUI) are available in Kali apt repositories. Binairies in path might have slightly different names, I'm using the ones in Kali.

## Server

```
powershell-empire server -h
sudo powershell-empire server
```

The empire server configuration file is located at `/etc/powershell-empire/server/config.yaml`.

You can change the default username and password from here(empireadmin:password123), also default directories.

The server saves everything in `/var/lib/powershell-empire/empire.db`, use this to start fresh or backup sessions.

## Client

### General

The empire server configuration file is located at `/etc/powershell-empire/client/config.yaml`



```
powershell-empire -h

# Will connect to localhost
powershell-empire client
```

**General commands**

```
help
back
info
set OPTION VALUE
execute
```

### Listeners

Used to receive shells. Have various options to blend in like different procotols, jitter and delay.

```
# List available
listeners

uselistener LISTENER_TYPE

enable | disable LISTENER_NAME
editinfo LISTENER_NAME
```

### Stagers

Generates a first stage file that you trigger on target.

```
usestager
```

### Agents

The result of the second stage stager from the listener. An enrypted channel, with pre-loaded functionality to make things easier - equivalent of a meterpreter.

You give the agents tasks, which will be performed and reported with the set delay. To view status of a task, use `view TASK_ID`

View availble commands with `help`.

```
agents
interact TARGET_NAME

info
whoami
upload
download
ps
shell
mimikatz
bypassuac

# Migrate to another process
psinject PROTOCOL PID
```

**Getting more agents**

To spawn a new agent via another protocol, set up a listener and use the model spawn. To spawn an agent as another user, use spawnas.

### Modules

Modules are used to further enumerate, harvets, exploit and pivot. Alot of existing projects are integrated into Empire, examples are:

- PowerView
- Mimikatz
- Rubeus
- SharpSploit, PowerSploit
- Core .NET functionality
- Bloodhound gatherer

They are divided by language used and the three languages are Powershell, C# and Python.

### Credentials

Credentials found are stored in the creds store. We can also add them manually and search for keywords in the store.

```
credentials
```

### Chat

```
chat
```

### Admin

The admin menu contains miscellaneous functions. All users can use the notes function:

**Notes**

```
admin
notes
add_notes ''
clear_notes
```

**Users**

```
user_list
create_user USERNAME PASSWORD
enable_user ID
disable_user ID
```

**Other**

```
report
obfuscate | deobfuscate
```

## Starkiller

Also installable via Kali repos. Essentially everything in client but in a nice GUI.

## Easy network pivoting

If you want to pivot through an existing agent, start a redirector listener with the agents name(pointing to your local listener). Run a module pointing to that redirector.
