# Miscellaneous linux stuff

## Bash/zsh
### Debugging scripts
Add '-x' when starting bash or in shebang of script to view more debugging info.

### Generating numbers
`echo {1..100} | tr ' ' '\n' > numbers.txt`

Generate numbers.txt containing the numbers 1-100, with a line break after each.

### Base conversion
```
(2#BYTE) # Will translate, if you press enter it will run as command.
echo "$((2#BYTE))" # To just print
echo "$((2#00000011))" # Will echo 3
```

Replace the 2# with any other base between 2 and 36.

### Check if file or folder exists
Works in both bash and zsh.
```bash
if [ -d *foldername* ]
then
  echo 'exists'
else
  echo 'not found'
fi

if [ -f *filename* ]
then
  echo 'exists'
else
  echo 'not found'
fi
```

### User input for scripts
Zsh
```zsh
vared -p 'Please input ' -c *variable-name*
```

Bash
```bash
read *variable-name* {*var2* *var3*}
read -p 'Prompt for input: ' *variable-name*
read -sp 'Prompt for input but silent: ' *variable-name*
```

### Multi execute on files with find
```
find *localtion* *search-parameters* -exec *command* {} \;
```

## DHCP server
- [Ubuntu community docs](https://help.ubuntu.com/community/isc-dhcp-server)
- [Debian wiki](https://wiki.debian.org/DHCP_Server)


To set up boxes running virtually, or sometimes to exploit, you might have to set up your own DHCP server.

- Install the 'isc-dhcp-server' package.
- Edit the `/etc/dhcp/dhcpd.conf`
- Start the service with service or systemctl.
- Current leases will be written to `/var/lib/dhcp/dhcpd.leases`

## Netcat magic
### Sending and receiving files
Receiver: `nc -l -p 1234 > out.file`
Sender: `nc -w 3 [destination] 1234 < out.file`

## Generating md5 hash
`python3 -c 'import hashlib;print(hashlib.md5(b"adminpassword").hexdigest())'` - hexformat.

`echo -n "something" | md5sum` - hexformat.

`openssl passwd -1 [text]` - This will be crypt compatible. See [pw-generation.](pw-generation.md)

## Kerberos
On kali, to use kerberos network authentication, install the 'krb5-user' package. Configuration in '/etc/krb5.conf'. To use domain:

![krb5-domain](assets/markdown-img-paste-20211107155106440.png)

## Time and NTP
Easiest way to update via target NTP server is to install (kali) the ntpdate package and run: `sudo ntpdate [serverip]`.

There's a service installed but not used by default, ntp. Use systemctl to run and config file in '/etc/ntp.conf'.

If systemd is used it uses timedatectl and timesyncd for time. Config file in '/etc/systemd/timesyncd.conf'.
```
timedatectl
timedatectl set-time "YYYY-MM-DD HH:MM:SS"
timedatectl set-ntp [true | false]
timedatectl timesync-status
timedatectl show-timesync
```

Easiest way to get approx the same time if smb is enabled:

`sudo timedatectl set-time "$(nmap $IP -p 445 --script smb2-time | grep date -m 1 | cut -d ":" -f 2- | tr "T" " ")"`

Only changes local time, might have to adjust time zones or universal time to get ex Kerberos working.

## Install and run LAMP on kali
- https://betterprogramming.pub/how-to-install-lamp-stack-on-kali-linux-183fa4f48d16

- Apache2 and mysql-common packages installed by default. Ohterwise install.
- Install latest php package(8 something right now), metapackage.
- Install libapache2-mod-php*version*
- Start apache2, mysql services.

Create index.php in /var/www/html:
```php
<?php
  phpinfo()
?>
```
And browse to it to check if its working.

To enable/disable mods in apache(changing versions) use a2dismod and a2enmod.

## Man pages
```
man -k searchword
man 5 searchword
apropos keyword
```
