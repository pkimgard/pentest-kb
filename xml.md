# XML
## XXE
XML External Entity

Using the XML SYSTEM entity to request files that we shouldn't have access to. Requires a poorly configured XML parser.

References:
- https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing
- https://www.w3.org/TR/REC-xml/#sec-external-ent
- https://book.hacktricks.xyz/pentesting-web/xxe-xee-xml-external-entity

### Testing for XXE
Capture the request and add a DOCTYPE:

```
<!DOCTYPE name [<!ENTITY name2 "text">]>
<something>&name2;</something>
```

This is a plain entity, only containing text. With this, '&name2;' should be replaced by 'text'.

### Showing files
Create a SYSTEM entity and reference a file.

```
<!DOCTYPE name [<!ENTITY name2 SYSTEM "file:///dir/file">]>
<something>&name2;</something>
```
### Other payloads
- https://github.com/payloadbox/xxe-injection-payload-list
