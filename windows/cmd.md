# CMD

## Basic, general

```
systeminfo
whoami /priv | /all | /user
type [filename]
cmdkey /list
runas /savecred /user:admin FILE
```

## The net command

* [MS Docs, net](https://docs.microsoft.com/en-us/troubleshoot/windows-server/networking/net-commands-on-operating-systems)

### Users and groups

* [MS Docs, net user](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc771865(v=ws.11))

```
# Listing information
net user | localgroup
net user | group /domain
net user USERNAME (/domain)
net group GROUPNAME (/domain)

# Change password or add user
net user USERNAME PASSWORD 
net user USERNAME PASSWORD /add

# Add user to to group
net localgroup administrators USERNAME /add
```

### Shares

* [MS Docs, net use](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/gg651155(v=ws.11))
* [MS Docs, net share](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/hh750728(v=ws.11))

```
net use Y: \\IP/NAME\Share [/savered]
net share SHARENAME
net share SHARENAME=DRIVE\PATH
net share SHARENAME /delete
```

## The dir command

* [MS Docs, dir](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/dir)

```
# List contents
dir

# List contents with ownership information
dir /q

# Search for filenames
dir /s FILENAME
```

## Searching for files or Content

```
dir /s *pass* == *.config
findstr /si password *.xml *.ini *.txt
```

## Permissions

```
icacls *dirpath*
```

## Services

```
net [stop | start] *servicename*

sc qc *servicename # Query Configuration
sc query *servicename* # Status
sc config *name* *option*= *value*
sc config daclsvc binpath= "C:\PrivEsc\merp.exe"
```

**Using wmic**

```
wmic service get [name | displayname | pathname | startmode]

# Get all services name and paths that autostarts.
wmic service get name,pathname | findstr /i "auto"

# Get all services names and paths except the windows default ones.
wmic service get name,pathname | findstr /i /v "c:\windows"
```

## Tasks

```
schtasks
schtasks /FO LIST /TN *TASKNAME* /v
```

## Registry

- https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg-add

```
reg query *HKLM\SYSTEM\CurrentControlSet\services\*
reg add *regentry* /v *value* /t *type* /d *data* /f #(No confirmation)
```

## Simple ping sweep

```
for /L %i in (1,1,255) do @ping -n 1 -w 200 192.168.0.%i > nul && echo 192.168.0.%i is up
```